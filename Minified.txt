function gElemsByClass(e,t){return null==t?document.getElementsByClassName(e):document.getElementsByClassName(e)[0].contentDocument.getElementsByClassName(t)}function gElemsBySelector(e,t){return null==t?document.querySelectorAll(e):document.getElementsByClassName(e)[0].contentDocument.querySelectorAll(t)}function tryF(e){try{e()}catch(e){}}console.log("Memrise Autocomplete By Brownie");var waitTilTrue=function(e,t){wait=setInterval((function(){e()&&setTimeout(t,100)}),10)};for(e in infoBox=function(e){document.body.innerHTML+=`<div class="acpopup infobox"><div style="right:1vw;bottom:-3vw;" class="acpopup closebutt" onclick="this.parentElement.remove()">Close</div><div>${e}</div></div>`},document.body.innerHTML+='<style>.infobox{width:50vw;height:min-content;top:50%;left:50%;transform:translate(-50%,-50%);}.prog{font-size:100px;margin-top:50px;}\n    .frame{border:0;z-index:99999;position:fixed;top:35vh;left:5vw;width:45vw;height:60vh;}.acpopup {z-index:9999;background-color:white;font-size:17px;position:fixed;\n    font-family:Monospace;border:solid lightgray 5px;padding:10px;}.closebutt{color:white;background-color:red;border-color:darkred;z-index:99999;cursor:pointer;opacity:1;}\n    .closebutt:hover{color:white;background-color:#FFA0A0;}</style></style><style class="levelhighlight">body.levels .levels .level:hover{background-color:lightblue;}</style>',dontCheckVer=!1,ver="v1.4",req=new XMLHttpRequest,req.open("GET","https://raw.githubusercontent.com/BrownieGit/MemriseAutocomplete/main/ver.txt",!0),req.onreadystatechange=function(){4==req.readyState&&200==req.status&&(recVer=req.responseText.trim(),console.log("Version check: '"+recVer+"' (Current version: '"+ver+"')"),recVer!=ver&&infoBox("A new version of Memrise Autocomplete is available!\n\nCurrent version: "+ver+"\nNew version: "+req.responseText+"\n\nPlease visit the script's GitHub page (https://github.com/BrownieGit/MemriseAutocomplete) to download the new version."))},dontCheckVer||req.send(),progBar="[data-testid=progressBar-0]",typingTest="[data-testid=typing-response-input]",testRootElem="[data-testid=testLearnableCard]",nextIcon="[data-testid=chevronRight]",completedNextIcon="[data-testid=tick]",questionIcon="[data-testid=question]",endOfSession="[data-testid=endOfSession]",apriframe="apriframe",ansiframe="ansiframe",text="text-text",prog="prog",len="length",ch="children",document.body.innerHTML+="<div class='acpopup selectp' \nstyle='top:10px;left:10px;'>Select set to complete (click):</div>",lvs=gElemsByClass("level"),lvs)try{lvs[e].removeAttribute("href"),lvs[e].setAttribute("onclick","init("+(parseInt(e)+1)+")")}catch{}window.init=function(t){for(e in lvs)try{lvs[e].removeAttribute("onclick"),gElemsByClass("levelhighlight").remove()}catch{}gElemsByClass("selectp")[0].remove(),document.body.innerHTML+="<div class='acpopup' style='box-sizing:border-box;top:5vh;left:5vw;width:90vw;height:90vh;padding:5vh;'>\n    Level progress: <div class='prog'>0%</div></div><div class='acpopup closebutt' style='top:4vh;right:5vw;' onclick='window.location=window.location'>Close</div><div class='progress' style='\n    position:fixed;z-index:99999;top:10vh;left:30vw;width:60vw;height:15vh;padding:20px;padding-top:10px;text-align:center;'>Memrise automation ("+ver+") by Brownie<br>\n    Dont click any buttons on the window because it may induce a stroke for the automation <br>\n    Click close and reopen bookmarklet to full flower session! <br><b>\n    For this to work best you need to Click Your Profile Picture > Click Settings > Click Learing and set Words per Session to 20 and turn OFF Audio Tests and Tapping Tests</b><br>\n    If the automation cant complete a test, please mannualy do it and it should continue as normal for other words. <br>\n    Uncompressed source code at https://github.com/BrownieGit/MemriseAutocomplete </div>\n    <iframe class='frame ansiframe' src='"+window.location+t+"/'></iframe><iframe class='frame apriframe' style='left:50vw;' src='https://app.memrise.com/aprender/learn?course_id="+(window.location+"").slice(31,38)+"&level_index="+t+"&source_element=level_details_session&source_screen=level_details'></iframe>",setInterval((function(){progElem=gElemsBySelector(apriframe,progBar),progElem[len]>0?gElemsByClass(prog)[0].innerHTML=Math.round(parseInt(progElem[0].style.width.slice(0,-1)))+"%":gElemsBySelector(apriframe,endOfSession)[len]>0&&(gElemsByClass(prog)[0].innerHTML="100%")}),50),ansloaded=!1,waitTilTrue((function(){return gElemsByClass(ansiframe,text)[len]>0&&!ansloaded}),(function(){for(e in ansJson={},ansElems=gElemsByClass(ansiframe,text),ansElems){for(c in a=[],ansElems[e][ch])tryF((()=>{ansElems[e][ch][c].classList.contains("col")&&a.push(ansElems[e][ch][c].innerText)}));2==a[len]&&(null==ansJson[a[0]]?ansJson[a[0]]=[a[1]]:ansJson[a[0]].push(a[1]),null==ansJson[a[1]]?ansJson[a[1]]=[a[0]]:ansJson[a[1]].push(a[0]))}console.log("Loaded answers:"),console.log(ansJson),ansloaded=!0})),waitTilTrue((function(){return tryF((()=>gElemsBySelector(apriframe,nextIcon)[0].parentElement.click())),tryF((()=>gElemsBySelector(apriframe,completedNextIcon)[0].parentElement.click())),gElemsBySelector(apriframe,questionIcon)[len]>0&&ansloaded}),(function(){que=gElemsBySelector(apriframe,testRootElem)[0][ch][1][ch][0][ch][0].innerText,gElemsBySelector(apriframe,typingTest)[len]>0?(gElemsBySelector(apriframe,typingTest)[0].value=ansJson[que][0].slice(0,-1),buttons=gElemsBySelector(apriframe,testRootElem)[0][ch][1][ch][0][ch][1][ch][2],ans=buttons.innerText.split("\n"),buttons[ch][ans.findIndex((function(e){return e==ansJson[que][0].slice(-1)}))].click()):(givenAnsElem=gElemsBySelector(apriframe,testRootElem)[0][ch][1][ch][0][ch][1],ans=givenAnsElem.innerText.split("\n"),8==ans[len]&&(ans=[ans[1],ans[3],ans[5],ans[7]]),correctarr=ansJson[que],givenAnsElem[ch][ans.findIndex((function(e){for(i in correctarr)if(e==correctarr[i])return!0;return!1}))][ch][0].click())}))};